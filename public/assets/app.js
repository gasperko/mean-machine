angular.module("app",["ngRoute","ui.router"]),angular.module("app").controller("errorCtrl",["$scope","$rootScope",function(e,t){e.hello="this is from the controller hello",console.log(e.hello)}]),angular.module("app").controller("homeCtrl",["$scope","$http","prognitor",function(e,t,o){e.apiUri="/api/data",o.run(e),e.setup(function(e){console.log(e)})}]),angular.module("app").controller("loginCtrl",["$scope","auth","$location","$timeout",function(e,t,o,n){e.authFail=!1,e.login=function(o,l){t.login(o,l).then(function(e){t.storeToken(e.data,function(){t.getUser().then(function(e){t.postLoginOps(e.data,function(){t.postLoginRouteHandler()})})})})["catch"](function(t){console.error("Gists error",t.status,t.data),401==t.status&&(e.authFail=!0,n(function(){e.authFail=!1},3e3))})["finally"](function(){console.log("finally finished gists")})}}]),angular.module("app").controller("masterCtrl",["$scope","$rootScope","$route","$http",function(e,t,o,n){console.log("masterCtrl"),localStorage.getItem("logged_user")&&(t.currentUser=localStorage.getItem("logged_user"),n.defaults.headers.common["x-auth"]=localStorage.getItem("user_token"),console.log(localStorage.getItem("user_token"))),e.$on("login",function(o,n){console.log("Logged In"),e.currentUser=n,t.currentUser=n,localStorage.setItem("logged_user",t.currentUser.username)})}]),angular.module("app").controller("navCtrl",["$scope","auth","$location",function(e,t,o){e.logout=function(){t.logout()}}]),angular.module("app").controller("newDataCtrl",["$scope","$http","$location",function(e,t,o){e.saveData=function(){console.log("save"),t.post("/api/data",{field1:e.field1,field2:e.field2,field3:e.field3,field4:e.field4}).then(function(e){console.log(e)},function(e){console.log(e)})}}]),angular.module("app").controller("registerCtrl",["$scope","auth","$location",function(e,t,o){e.register=function(n,l,r){t.register(n,l,r).then(function(n){t.login(l,r),e.$emit("login",n.data),o.path("/home")})["catch"](function(e){console.log(e)})}}]),angular.module("app").config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,o){t.otherwise("/"),e.state("app",{url:"/",views:{header:{templateUrl:"/nav.html",controller:"navCtrl"},content:{templateUrl:"/login.html",controller:"loginCtrl"}}}).state("app.login",{url:"login",views:{header:{templateUrl:"/nav.html",controller:"navCtrl"},content:{templateUrl:"/login.html",controller:"loginCtrl"}}}).state("app.register",{url:"register",views:{"content@":{templateUrl:"register.html",controller:"registerCtrl"}}}).state("app.validate",{url:"signup/validate/:id",views:{"content@":{templateUrl:"users/validate.html",controller:"validateCtrl"}}}).state("app.home",{url:"home",views:{"content@":{templateUrl:"users/home.html",controller:"homeCtrl"}}}).state("app.home.data",{url:"/data/new",views:{"content@":{templateUrl:"users/newData.html",controller:"newDataCtrl"}}}).state("app.home.details",{url:"/vehicles/:id",views:{"content@":{templateUrl:"vehicles/editVehicle.html",controller:"VehiclesEditInfoCtrl"}}}).state("app.home.map",{url:"/vehicles/map/:id",views:{"content@":{templateUrl:"vehicles/mapVehicle.html",controller:"VehiclesEditMapCtrl"}}}),o.html5Mode(!0)}]),angular.module("app").controller("validateCtrl",["$scope","$http","$stateParams",function(e,t,o){e.loading=!0,t.get("api/users/validate/"+o.id).then(function(t){console.log(t),200==t.status?(e.verified=!0,e.loading=!1):(e.verified=!1,e.loading=!1)})}]),angular.module("app").service("auth",["$http","$window","$location","$rootScope",function(e,t,o,n){function l(){return e.get("api/users")}function r(t,o){return e.post("api/sessions",{username:t,password:o})}function a(t,o,n){return e.post("api/users",{name:t,username:o,password:n})}function i(){localStorage.removeItem("user_token"),localStorage.removeItem("logged_user"),delete e.defaults.headers.common["x-auth"],n.isLogged=!1,n.currentUser=null,o.path("/login")}function s(o,n){t.sessionStorage.user_token=o,localStorage.setItem("user_token",o),e.defaults.headers.common["x-auth"]=t.sessionStorage.user_token,n&&"function"==typeof n&&n()}function u(){}function c(e,t){n.currentUser=e.name,localStorage.setItem("logged_user",n.currentUser),n.isLogged=!0,t&&"function"==typeof t&&t()}function g(){n.intendedRoute?o.path(n.intendedRoute):o.path("/home")}return{getUser:l,login:r,register:a,logout:i,storeToken:s,isLogged:u,postLoginOps:c,postLoginRouteHandler:g}}]),angular.module("app").service("prognitor",["$http","$window","$location","$rootScope",function(e,t,o,n){return{setSetupProcess:function(t){t.loading=!1,console.log(t),t.setup=function(o){t.loading||(t.loading=!0,e.get(t.apiUri).then(function(e){console.log(e),void 0!==o&&o(e)},function(e){404==e.status&&n.$broadcast("render404")}))}},run:function(e){console.log("in prognitor service"),this.setSetupProcess(e)}}}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImNvbnRyb2xsZXJzL2Vycm9yQ3RybC5qcyIsImNvbnRyb2xsZXJzL2hvbWVDdHJsLmpzIiwiY29udHJvbGxlcnMvbG9naW5DdHJsLmpzIiwiY29udHJvbGxlcnMvbWFzdGVyQ3RybC5qcyIsImNvbnRyb2xsZXJzL25hdkN0cmwuanMiLCJjb250cm9sbGVycy9uZXdEYXRhQ3RybC5qcyIsImNvbnRyb2xsZXJzL3JlZ2lzdGVyQ3RybC5qcyIsImNvbnRyb2xsZXJzL3JvdXRlcy5qcyIsImNvbnRyb2xsZXJzL3ZhbGlkYXRlQ3RybC5qcyIsInNlcnZpY2VzL2F1dGguanMiLCJzZXJ2aWNlcy9wcm9nbml0b3IuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkc2NvcGUiLCIkcm9vdFNjb3BlIiwiaGVsbG8iLCJjb25zb2xlIiwibG9nIiwiJGh0dHAiLCJwcm9nbml0b3IiLCJhcGlVcmkiLCJydW4iLCJzZXR1cCIsInJlcyIsImF1dGgiLCIkbG9jYXRpb24iLCIkdGltZW91dCIsImF1dGhGYWlsIiwibG9naW4iLCJ1c2VybmFtZSIsInBhc3N3b3JkIiwidGhlbiIsInN0b3JlVG9rZW4iLCJkYXRhIiwiZ2V0VXNlciIsInBvc3RMb2dpbk9wcyIsInBvc3RMb2dpblJvdXRlSGFuZGxlciIsInJlc3BvbnNlIiwiZXJyb3IiLCJzdGF0dXMiLCIkcm91dGUiLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiY3VycmVudFVzZXIiLCJkZWZhdWx0cyIsImhlYWRlcnMiLCJjb21tb24iLCIkb24iLCJfIiwidXNlciIsInNldEl0ZW0iLCJsb2dvdXQiLCJzYXZlRGF0YSIsInBvc3QiLCJmaWVsZDEiLCJmaWVsZDIiLCJmaWVsZDMiLCJmaWVsZDQiLCJyZWdpc3RlciIsIm5hbWUiLCIkZW1pdCIsInBhdGgiLCJlcnIiLCJjb25maWciLCIkc3RhdGVQcm92aWRlciIsIiR1cmxSb3V0ZXJQcm92aWRlciIsIiRsb2NhdGlvblByb3ZpZGVyIiwib3RoZXJ3aXNlIiwic3RhdGUiLCJ1cmwiLCJ2aWV3cyIsImhlYWRlciIsInRlbXBsYXRlVXJsIiwiY29udGVudCIsImNvbnRlbnRAIiwiaHRtbDVNb2RlIiwiJHN0YXRlUGFyYW1zIiwibG9hZGluZyIsImdldCIsImlkIiwidmVyaWZpZWQiLCJzZXJ2aWNlIiwiJHdpbmRvdyIsInJlbW92ZUl0ZW0iLCJpc0xvZ2dlZCIsImNiIiwic2Vzc2lvblN0b3JhZ2UiLCJ1c2VyX3Rva2VuIiwiaW50ZW5kZWRSb3V0ZSIsInNldFNldHVwUHJvY2VzcyIsImNhbGxiYWNrRm4iLCJ1bmRlZmluZWQiLCIkYnJvYWRjYXN0IiwidGhpcyJdLCJtYXBwaW5ncyI6IkFBQUFBLFFBQUFDLE9BQUEsT0FDQSxVQUFBLGNDREFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxhQUFBLFNBQUEsYUFBQSxTQUFBQyxFQUFBQyxHQUNBRCxFQUFBRSxNQUFBLG9DQUNBQyxRQUFBQyxJQUFBSixFQUFBRSxVQ0hBTCxRQUFBQyxPQUFBLE9BQ0FDLFdBQUEsWUFBQSxTQUFBLFFBQUEsWUFBQSxTQUFBQyxFQUFBSyxFQUFBQyxHQUlBTixFQUFBTyxPQUFBLFlBQ0FELEVBQUFFLElBQUFSLEdBQ0FBLEVBQUFTLE1BQUEsU0FBQUMsR0FDQVAsUUFBQUMsSUFBQU0sUUNSQWIsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLGFBQUEsU0FBQSxPQUFBLFlBQUEsV0FBQSxTQUFBQyxFQUFBVyxFQUFBQyxFQUFBQyxHQUNBYixFQUFBYyxVQUFBLEVBQ0FkLEVBQUFlLE1BQUEsU0FBQUMsRUFBQUMsR0FDQU4sRUFBQUksTUFBQUMsRUFBQUMsR0FDQUMsS0FBQSxTQUFBUixHQUNBQyxFQUFBUSxXQUFBVCxFQUFBVSxLQUFBLFdBQ0FULEVBQUFVLFVBQ0FILEtBQUEsU0FBQVIsR0FDQUMsRUFBQVcsYUFBQVosRUFBQVUsS0FBQSxXQUNBVCxFQUFBWSxnQ0FOQVosU0FZQSxTQUFBYSxHQUNBckIsUUFBQXNCLE1BQUEsY0FBQUQsRUFBQUUsT0FB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QUEsSUFDQUEsSUFLQSxRQUFBakQsS0FDQXRCLEVBQUEwRSxjQUNBL0QsRUFBQW9DLEtBQUEvQyxFQUFBMEUsZUFFQS9ELEVBQUFvQyxLQUFBLFNBM0VBLE9BQ0EzQixRQUFBQSxFQUNBTixNQUFBQSxFQUNBOEIsU0FBQUEsRUFDQVAsT0FBQUEsRUFDQW5CLFdBQUFBLEVBQ0FvRCxTQUFBQSxFQUNBakQsYUFBQUEsRUFDQUMsc0JBQUFBLE1DWEExQixRQUFBQyxPQUFBLE9BQ0FzRSxRQUFBLGFBQUEsUUFBQSxVQUFBLFlBQUEsYUFBQSxTQUFBL0QsRUFBQWdFLEVBQUF6RCxFQUFBWCxHQUVBLE9BR0EyRSxnQkFBQSxTQUFBNUUsR0FDQUEsRUFBQWdFLFNBQUEsRUFDQTdELFFBQUFDLElBQUFKLEdBQ0FBLEVBQUFTLE1BQUEsU0FBQW9FLEdBQ0E3RSxFQUFBZ0UsVUFFQWhFLEVBQUFnRSxTQUFBLEVBR0EzRCxFQUFBNEQsSUFBQWpFLEVBQUFPLFFBQ0FXLEtBQUEsU0FBQUUsR0FDQWpCLFFBQUFDLElBQUFnQixHQUlBMEQsU0FBQUQsR0FDQUEsRUFBQXpELElBQ0EsU0FBQVYsR0FDQSxLQUFBQSxFQUFBZ0IsUUFDQXpCLEVBQUE4RSxXQUFBLGtCQVFBdkUsSUFBQSxTQUFBUixHQUNBRyxRQUFBQyxJQUFBLHdCQUNBNEUsS0FBQUosZ0JBQUE1RSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJhbmd1bGFyLm1vZHVsZSgnYXBwJyxbXHJcbiduZ1JvdXRlJywndWkucm91dGVyJ1xyXG5dKSIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ2Vycm9yQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSkge1xyXG4gICAgICAgICRzY29wZS5oZWxsbyA9IFwidGhpcyBpcyBmcm9tIHRoZSBjb250cm9sbGVyIGhlbGxvXCJcclxuICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUuaGVsbG8pXHJcblxyXG5cclxuXHJcbiAgICB9KVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5jb250cm9sbGVyKCdob21lQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGh0dHAsIHByb2duaXRvcikge1xyXG5cclxuXHJcblxyXG4gICAgICAgICRzY29wZS5hcGlVcmkgPSBcIi9hcGkvZGF0YVwiXHJcbiAgICAgICAgcHJvZ25pdG9yLnJ1bigkc2NvcGUpXHJcbiAgICAgICAgJHNjb3BlLnNldHVwKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzKVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAvKiRodHRwLmdldCgnL2FwaS92ZWhpY2xlJylcclxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJHNjb3BlLm1vZGVsID0gcmVzcG9uc2UuZGF0YTtcclxuXHJcbiAgICAgICAgICAgICAgICB9LCBmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vIGNhbGxlZCBhc3luY2hyb25vdXNseSBpZiBhbiBlcnJvciBvY2N1cnNcclxuICAgICAgICAgICAgICAgICAgICAvLyBvciBzZXJ2ZXIgcmV0dXJucyByZXNwb25zZSB3aXRoIGFuIGVycm9yIHN0YXR1cy5cclxuICAgICAgICAgICAgICAgIH0pOyovXHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcblxyXG4gICAgfSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuY29udHJvbGxlcignbG9naW5DdHJsJywgZnVuY3Rpb24oJHNjb3BlLCBhdXRoLCAkbG9jYXRpb24sICR0aW1lb3V0KSB7XHJcbiAgICAgICAgJHNjb3BlLmF1dGhGYWlsID0gZmFsc2U7XHJcbiAgICAgICAgJHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKSB7XHJcbiAgICAgICAgICAgIGF1dGgubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxyXG4gICAgICAgICAgICAgICAgLnRoZW4oZnVuY3Rpb24ocmVzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgYXV0aC5zdG9yZVRva2VuKHJlcy5kYXRhLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5nZXRVc2VyKClcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGF1dGgucG9zdExvZ2luT3BzKHJlcy5kYXRhLCBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXV0aC5wb3N0TG9naW5Sb3V0ZUhhbmRsZXIoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ0dpc3RzIGVycm9yJywgcmVzcG9uc2Uuc3RhdHVzLCByZXNwb25zZS5kYXRhKTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUuYXV0aEZhaWwgPSB0cnVlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkgeyAkc2NvcGUuYXV0aEZhaWwgPSBmYWxzZTsgfSwgMzAwMCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5maW5hbGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFwiZmluYWxseSBmaW5pc2hlZCBnaXN0c1wiKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuXHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuY29udHJvbGxlcignbWFzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJHJvb3RTY29wZSwgJHJvdXRlLCAkaHR0cCkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKFwibWFzdGVyQ3RybFwiKTtcclxuXHJcbiAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCdsb2dnZWRfdXNlcicpKSB7ICAgICAgICBcdFxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2xvZ2dlZF91c2VyJylcclxuICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VzZXJfdG9rZW4nKVxyXG4gICAgICAgICAgICBjb25zb2xlLmxvZyhsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndXNlcl90b2tlbicpKVxyXG4gICAgICAgIH1cclxuICAgICAgICAkc2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJMb2dnZWQgSW5cIik7XHJcbiAgICAgICAgICAgICRzY29wZS5jdXJyZW50VXNlciA9IHVzZXJcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5jdXJyZW50VXNlciA9IHVzZXJcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xvZ2dlZF91c2VyJywgJHJvb3RTY29wZS5jdXJyZW50VXNlci51c2VybmFtZSlcclxuICAgICAgICB9KVxyXG4gICAgfSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuY29udHJvbGxlcignbmF2Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgYXV0aCwgJGxvY2F0aW9uKSB7ICAgICAgICBcclxuICAgICAgICAkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7ICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGF1dGgubG9nb3V0KCkgICAgICAgICAgICAgICAgXHJcblxyXG4gICAgICAgIH1cclxuICAgIH0pXHJcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyXG4gICAgLmNvbnRyb2xsZXIoJ25ld0RhdGFDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJGxvY2F0aW9uKSB7XHJcblxyXG5cclxuICAgICAgICAkc2NvcGUuc2F2ZURhdGEgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coXCJzYXZlXCIpXHJcbiAgICAgICAgICAgICRodHRwLnBvc3QoJy9hcGkvZGF0YScsIHtcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZDE6ICRzY29wZS5maWVsZDEsXHJcbiAgICAgICAgICAgICAgICAgICAgZmllbGQyOiAkc2NvcGUuZmllbGQyLFxyXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkMzogJHNjb3BlLmZpZWxkMyxcclxuICAgICAgICAgICAgICAgICAgICBmaWVsZDQ6ICRzY29wZS5maWVsZDRcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXNwb25zZSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKVxyXG4gICAgICAgICAgICAgICAgfSwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcclxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZSlcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICB9KVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuLmNvbnRyb2xsZXIoJ3JlZ2lzdGVyQ3RybCcsZnVuY3Rpb24oJHNjb3BlLGF1dGgsJGxvY2F0aW9uKXtcclxuXHRcclxuXHQkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbihuYW1lLHVzZXJuYW1lLHBhc3N3b3JkKXtcclxuXHRcdGF1dGgucmVnaXN0ZXIobmFtZSx1c2VybmFtZSxwYXNzd29yZClcclxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcdFx0XHRcclxuXHRcdFx0YXV0aC5sb2dpbih1c2VybmFtZSxwYXNzd29yZClcclxuXHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicscmVzcG9uc2UuZGF0YSlcclxuXHRcdFx0JGxvY2F0aW9uLnBhdGgoJy9ob21lJylcclxuXHRcdH0pXHJcblx0XHQuY2F0Y2goZnVuY3Rpb24gKGVycil7XHJcblx0XHRcdGNvbnNvbGUubG9nKGVycilcclxuXHRcdH0pXHJcblx0fVxyXG5cclxufSlcclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbi5jb25maWcoZnVuY3Rpb24oJHN0YXRlUHJvdmlkZXIsICR1cmxSb3V0ZXJQcm92aWRlciwkbG9jYXRpb25Qcm92aWRlcil7XHJcbiBcclxuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy8nKTtcclxuIFxyXG4gICAgJHN0YXRlUHJvdmlkZXJcclxuICAgIC5zdGF0ZSgnYXBwJyx7XHJcbiAgICAgICAgdXJsOiAnLycsXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgJ2hlYWRlcic6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL25hdi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICduYXZDdHJsJ1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAnY29udGVudCc6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnL2xvZ2luLmh0bWwnICxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9KVxyXG5cclxuICAgIC5zdGF0ZSgnYXBwLmxvZ2luJyx7XHJcbiAgICAgICAgdXJsOiAnbG9naW4nLFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgICdoZWFkZXInOiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9uYXYuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnbmF2Q3RybCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgJ2NvbnRlbnQnOiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy9sb2dpbi5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICdsb2dpbkN0cmwnXHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfSlcclxuIFxyXG4gICAgLnN0YXRlKCdhcHAucmVnaXN0ZXInLCB7XHJcbiAgICAgICAgdXJsOiAncmVnaXN0ZXInLFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAncmVnaXN0ZXIuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAncmVnaXN0ZXJDdHJsJ1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gXHJcbiAgICB9KVxyXG5cclxuICAgIC5zdGF0ZSgnYXBwLnZhbGlkYXRlJywge1xyXG4gICAgICAgIHVybDogJ3NpZ251cC92YWxpZGF0ZS86aWQnLCAgICAgICAgXHJcbiBcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAnY29udGVudEAnOiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3VzZXJzL3ZhbGlkYXRlLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ3ZhbGlkYXRlQ3RybCcgICAgICAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gXHJcbiAgICB9KVxyXG5cclxuIFxyXG4gICAgLnN0YXRlKCdhcHAuaG9tZScsIHtcclxuICAgICAgICB1cmw6ICdob21lJyxcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAnY29udGVudEAnOiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3VzZXJzL2hvbWUuaHRtbCcsXHJcbiAgICAgICAgICAgICAgICBjb250cm9sbGVyOiAnaG9tZUN0cmwnXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiBcclxuICAgIH0pXHJcblxyXG4gICAgIC5zdGF0ZSgnYXBwLmhvbWUuZGF0YScsIHtcclxuICAgICAgICB1cmw6ICcvZGF0YS9uZXcnLFxyXG4gICAgICAgIHZpZXdzOiB7XHJcbiAgICAgICAgICAgICdjb250ZW50QCc6IHtcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAndXNlcnMvbmV3RGF0YS5odG1sJyxcclxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXI6ICduZXdEYXRhQ3RybCdcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuIFxyXG4gICAgfSlcclxuXHJcbiAgICAgLnN0YXRlKCdhcHAuaG9tZS5kZXRhaWxzJywge1xyXG4gICAgICAgIHVybDogJy92ZWhpY2xlcy86aWQnLCAgICAgICAgXHJcbiBcclxuICAgICAgICB2aWV3czoge1xyXG4gICAgICAgICAgICAnY29udGVudEAnOiB7XHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ3ZlaGljbGVzL2VkaXRWZWhpY2xlLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlaGljbGVzRWRpdEluZm9DdHJsJyAgICAgICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiBcclxuICAgIH0pXHJcblxyXG4gICAgIC5zdGF0ZSgnYXBwLmhvbWUubWFwJywge1xyXG4gICAgICAgIHVybDogJy92ZWhpY2xlcy9tYXAvOmlkJywgICAgICAgIFxyXG4gXHJcbiAgICAgICAgdmlld3M6IHtcclxuICAgICAgICAgICAgJ2NvbnRlbnRAJzoge1xyXG4gICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICd2ZWhpY2xlcy9tYXBWZWhpY2xlLmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ1ZlaGljbGVzRWRpdE1hcEN0cmwnICAgICAgICBcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuIFxyXG4gICAgfSlcclxuXHJcblxyXG4gICAgXHJcbiBcclxuICAgICRsb2NhdGlvblByb3ZpZGVyLmh0bWw1TW9kZSh0cnVlKVxyXG4gXHJcbn0pO1xyXG5cclxuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuY29udHJvbGxlcigndmFsaWRhdGVDdHJsJywgZnVuY3Rpb24oJHNjb3BlLCAkaHR0cCwgJHN0YXRlUGFyYW1zKSB7XHJcblxyXG4gICAgICAgIFxyXG4gICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZVxyXG5cclxuICAgICAgICAkaHR0cC5nZXQoJ2FwaS91c2Vycy92YWxpZGF0ZS8nICsgJHN0YXRlUGFyYW1zLmlkKVxyXG4gICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXMpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcylcclxuICAgICAgICAgICAgICAgIGlmKHJlcy5zdGF0dXMgPT0gMjAwKXtcclxuICAgICAgICAgICAgICAgIFx0JHNjb3BlLnZlcmlmaWVkID0gdHJ1ZVxyXG4gICAgICAgICAgICAgICAgXHQkc2NvcGUubG9hZGluZyA9IGZhbHNlXHJcbiAgICAgICAgICAgICAgICB9ZWxzZXtcclxuICAgICAgICAgICAgICAgIFx0JHNjb3BlLnZlcmlmaWVkID0gZmFsc2VcclxuICAgICAgICAgICAgICAgIFx0JHNjb3BlLmxvYWRpbmcgPSBmYWxzZVxyXG4gICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgfSlcclxuXHJcblxyXG5cclxuXHJcbiAgICB9KVxyXG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5zZXJ2aWNlKCdhdXRoJywgZnVuY3Rpb24oJGh0dHAsICR3aW5kb3csICRsb2NhdGlvbiwgJHJvb3RTY29wZSkge1xyXG5cclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgZ2V0VXNlcjogZ2V0VXNlcixcclxuICAgICAgICAgICAgbG9naW46IGxvZ2luLFxyXG4gICAgICAgICAgICByZWdpc3RlcjogcmVnaXN0ZXIsXHJcbiAgICAgICAgICAgIGxvZ291dDogbG9nb3V0LFxyXG4gICAgICAgICAgICBzdG9yZVRva2VuOiBzdG9yZVRva2VuLFxyXG4gICAgICAgICAgICBpc0xvZ2dlZDogaXNMb2dnZWQsXHJcbiAgICAgICAgICAgIHBvc3RMb2dpbk9wczogcG9zdExvZ2luT3BzLFxyXG4gICAgICAgICAgICBwb3N0TG9naW5Sb3V0ZUhhbmRsZXI6IHBvc3RMb2dpblJvdXRlSGFuZGxlclxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFVzZXIoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoJ2FwaS91c2VycycpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBsb2dpbih1c2VybmFtZSwgcGFzc3dvcmQpIHtcclxuXHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvc2Vzc2lvbnMnLCB7XHJcbiAgICAgICAgICAgICAgICB1c2VybmFtZTogdXNlcm5hbWUsXHJcbiAgICAgICAgICAgICAgICBwYXNzd29yZDogcGFzc3dvcmRcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHJlZ2lzdGVyKG5hbWUsIHVzZXJuYW1lLCBwYXNzd29yZCkge1xyXG5cclxuICAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvdXNlcnMnLCB7XHJcbiAgICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxyXG4gICAgICAgICAgICAgICAgdXNlcm5hbWU6IHVzZXJuYW1lLFxyXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IHBhc3N3b3JkXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgfVxyXG5cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbG9nb3V0KCkge1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgndXNlcl90b2tlbicpO1xyXG4gICAgICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnbG9nZ2VkX3VzZXInKTtcclxuICAgICAgICAgICAgZGVsZXRlICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWyd4LWF1dGgnXVxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmlzTG9nZ2VkID0gZmFsc2U7XHJcbiAgICAgICAgICAgICRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsO1xyXG4gICAgICAgICAgICAkbG9jYXRpb24ucGF0aChcIi9sb2dpblwiKVxyXG5cclxuXHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc3RvcmVUb2tlbihyZXMsIGNiKSB7XHJcbiAgICAgICAgICAgICR3aW5kb3cuc2Vzc2lvblN0b3JhZ2VbXCJ1c2VyX3Rva2VuXCJdID0gcmVzXHJcbiAgICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKCd1c2VyX3Rva2VuJywgcmVzKTtcclxuICAgICAgICAgICAgJGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ3gtYXV0aCddID0gJHdpbmRvdy5zZXNzaW9uU3RvcmFnZS51c2VyX3Rva2VuXHJcbiAgICAgICAgICAgIGlmIChjYiAmJiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gaXNMb2dnZWQoKSB7XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gcG9zdExvZ2luT3BzKHJlcywgY2IpIHtcclxuXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gcmVzLm5hbWVcclxuICAgICAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ2xvZ2dlZF91c2VyJywgJHJvb3RTY29wZS5jdXJyZW50VXNlcilcclxuICAgICAgICAgICAgJHJvb3RTY29wZS5pc0xvZ2dlZCA9IHRydWU7XHJcbiAgICAgICAgICAgIGlmIChjYiAmJiAodHlwZW9mIGNiID09PSAnZnVuY3Rpb24nKSkge1xyXG4gICAgICAgICAgICAgICAgY2IoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHBvc3RMb2dpblJvdXRlSGFuZGxlcigpIHtcclxuICAgICAgICAgICAgaWYgKCRyb290U2NvcGUuaW50ZW5kZWRSb3V0ZSkge1xyXG4gICAgICAgICAgICAgICAgJGxvY2F0aW9uLnBhdGgoJHJvb3RTY29wZS5pbnRlbmRlZFJvdXRlKTtcclxuICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICRsb2NhdGlvbi5wYXRoKCcvaG9tZScpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG5cclxuICAgIH0pXHJcbiIsIlxyXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcclxuICAgIC5zZXJ2aWNlKCdwcm9nbml0b3InLCBmdW5jdGlvbigkaHR0cCwgJHdpbmRvdywgJGxvY2F0aW9uLCAkcm9vdFNjb3BlKSB7XHJcblxyXG4gICAgICAgIHJldHVybiB7XHJcblxyXG5cclxuICAgICAgICAgICAgc2V0U2V0dXBQcm9jZXNzOiBmdW5jdGlvbigkc2NvcGUpIHtcclxuICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkc2NvcGUpXHJcbiAgICAgICAgICAgICAgICAkc2NvcGUuc2V0dXAgPSBmdW5jdGlvbihjYWxsYmFja0ZuKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCRzY29wZS5sb2FkaW5nKSByZXR1cm47XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRzY29wZS5sb2FkaW5nID0gdHJ1ZTtcclxuXHJcblxyXG4gICAgICAgICAgICAgICAgICAgICRodHRwLmdldCgkc2NvcGUuYXBpVXJpKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihkYXRhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhkYXRhKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAvKiAkc2NvcGUuc3RhdGUubGFzdFBhZ2UgPSBkYXRhLmxhc3RfcGFnZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICRzY29wZS5pc0xhc3RQYWdlID0gKCRzY29wZS5zdGF0ZS5wYWdlTnVtID09ICRzY29wZS5zdGF0ZS5sYXN0UGFnZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkc2NvcGUubG9hZGluZyA9IGZhbHNlOyovXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoY2FsbGJhY2tGbiAhPT0gdW5kZWZpbmVkKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrRm4oZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sIGZ1bmN0aW9uKHJlcykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT0gNDA0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS4kYnJvYWRjYXN0KCdyZW5kZXI0MDQnKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSxcclxuXHJcblxyXG4gICAgICAgICAgICBydW46IGZ1bmN0aW9uKCRzY29wZSkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coXCJpbiBwcm9nbml0b3Igc2VydmljZVwiKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5zZXRTZXR1cFByb2Nlc3MoJHNjb3BlKTtcclxuXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuXHJcbiAgICB9KVxyXG4iXX0=
